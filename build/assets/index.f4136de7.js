import{j as p,a as m,r as i,R as I,b as $}from"./vendor.a7bcea1a.js";const k=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function r(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerpolicy&&(s.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?s.credentials="include":t.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(t){if(t.ep)return;t.ep=!0;const s=r(t);fetch(t.href,s)}};k();const o=p.exports.jsx,u=p.exports.jsxs,v=p.exports.Fragment,f=({handler:e,value:n,name:r})=>u("div",{children:[u("label",{htmlFor:r,children:[r,": "]}),o("input",{name:r,onChange:e,value:n})]}),M=()=>m.get("http://localhost:3001/api/persons").then(e=>{const{data:n}=e;return n}),O=e=>m.post("http://localhost:3001/api/persons",e),A=e=>m.delete(`http://localhost:3001/api/persons/${e}`),R=(e,n)=>m.put(`http://localhost:3001/api/persons/${e}`,n).then(r=>{const{data:l}=r;return l}),D=({data:e,message:n})=>{const[r,l]=i.exports.useState(!1),t=()=>{window.confirm(`Delete ${e.name}`)&&(A(e.id).catch(()=>n(`Information of ${e.name} was already removed from server`)),l(!0))};return r?o(v,{}):u("li",{children:[u("span",{children:[e.name," ",e.number," "]}),o("button",{onClick:t,children:"delete"})]})},E=({list:e,message:n})=>o("ul",{children:e.map(r=>o(D,{data:r,message:n},r.name))}),q=({detail:e})=>e===null?null:o("div",{className:"ok",children:e}),B=()=>{const[e,n]=i.exports.useState([]),[r,l]=i.exports.useState(""),[t,s]=i.exports.useState(""),[d,y]=i.exports.useState(""),[N,g]=i.exports.useState(null);i.exports.useEffect(()=>{M().then(a=>n(a)).catch(console.log)},[]);const P=a=>{y(a.target.value)},L=a=>{l(a.target.value)},S=a=>{s(a.target.value)},C=a=>{a.preventDefault();const c={name:r,number:t,id:e.length+1},b=e.filter(w=>w.name.toLowerCase()===c.name.toLowerCase());b.length===0?O(c).then(n([...e,c])).then(()=>h(`Added ${c.name}`)).catch(console.log):confirm(`${c.name} is already added to phonebook, replace the old number with a new one?`)&&R(b[0].id,c).then(w=>{n(e.map(x=>x.name.toLowerCase()===c.name.toLowerCase()?c:x))}).then(h(`Updated Information of  ${c.name}`)).catch(console.log),l(""),s("")},h=a=>{g(a),setTimeout(()=>g(null),5e3)},F=new RegExp(d,"gi"),j=e.filter(a=>F.test(a.name));return u(v,{children:[u("form",{children:[o("h1",{children:"Phonebook"}),o(q,{detail:N}),o(f,{handler:P,value:d,name:"filter"}),o("h3",{children:"Add a new Phone"}),o(f,{handler:L,value:r,name:"name"}),o(f,{handler:S,value:t,name:"number"}),o("button",{type:"submit",onClick:C,children:"Add Number"})]}),o("h2",{children:"Numbers"}),o(E,{list:j,message:h})]})};I.render(o($.StrictMode,{children:o(B,{})}),document.getElementById("root"));
